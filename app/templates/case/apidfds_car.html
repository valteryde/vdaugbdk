{% extends "case/base.html" %}

{% block title %}Case - Den Frie Digitale Skole{% endblock %}
{% block head %}


<link rel="stylesheet" href="{{ url_for('static', filename='case.css') }}">


{% endblock %}


{% block body %}

<section class="padded-section">

    <!-- <h2 class="section-title">/case</h2> -->
    <h1 class="project-title">Den Frie Digitale Skole</h1>
    <p class="project-subtitle">A fullstack Python web app for online education, <i>built with the technologies below.</i></p>

    <div class="carousel" id="carousel-techstack" style="--aspect-ratio: 16/9;">
        
        <div class="carousel-track">
            <div class="carousel-item">
                <img src="{{ url_for('static', filename='apidfds/carousel/flask.png') }}">
                <h2>Flask</h2>
                <p>Flask is used for controlling the backend of the application.</p>
            </div>
            <div class="carousel-item">
                <img src="{{ url_for('static', filename='apidfds/carousel/celery.png') }}">
                <h2>Celery</h2>
                <p>Celery is used for handling asynchronous tasks and background jobs, such as gathering data from APIs.</p>
            </div>
            <div class="carousel-item">
                <img src="{{ url_for('static', filename='apidfds/carousel/gunicorn.png') }}">
                <h2>Gunicorn</h2>
                <p>Gunicorn is a Python WSGI HTTP server for UNIX.</p>
            </div>
            <div class="carousel-item">
                <img src="{{ url_for('static', filename='apidfds/carousel/nginx.png') }}" style="height:10px;">
                <h2>NGINX</h2>
                <p>NGINX is used as a reverse proxy server to handle client requests and serve static files.</p>
            </div>
            <div class="carousel-item">
                <img src="{{ url_for('static', filename='apidfds/carousel/postgresql.png') }}">
                <h2>PostgreSQL</h2>
                <p>PostgreSQL is a powerful, open source object-relational database system.</p>
            </div>
            <div class="carousel-item">
                <img src="{{ url_for('static', filename='apidfds/carousel/redis.png') }}">
                <h2>Redis</h2>
                <p>Redis is an in-memory data structure store, used as a database, cache, and message broker.</p>
            </div>
            <div class="carousel-item">
                <img src="{{ url_for('static', filename='apidfds/carousel/python.png') }}">
                <h2>Python</h2>
                <p>Python is a programming language used for backend development.</p>
            </div>
        </div>
    </div>

    <p class="m-text">During my time as a teacher, I was responsible for developing an application that <strong>automatically retrieved schedules from Google Sheets and displayed them live</strong> on each student's personal learning site. This solution enabled both teachers and students to benefit from real-time updates, significantly reducing manual administrative work.</p>
    <p class="m-text">The scope of the project quickly expanded to include additional features such as:</p>
                      
</section>

<section id="card-section">
    <!-- <h2 class="archive-title">Project Screenshots</h2> -->
    <h2 class="section-title" style="margin-bottom:30px;margin-top:60px;">/project screenshots</h2>

    <div class="archive-grid">
        
        {% for card in project.body.cards %}
        <div class="archive-card" 
            data-image="/static/{{ project.head.folder }}/{{ card.image }}" 
            data-title="{{ card.title }}" 
            data-description="{{ card.description }}"
            data-keyfeatures="{{ card.keyfeatures | join(', ') }}"
        >
            <!-- Add a dual canvas -->
            <div class="canvas-container card-dual-canvas">
                <canvas class="compute-canvas" width="500" height="200"></canvas>
                <canvas class="render-canvas" width="1000" height="400"></canvas>
            </div>

            <div class="card-content">
                <div class="card-header">
                    <!-- <span class="card-id">DFDS-001</span> -->
                    <span class="card-classification">Core Feature</span>
                </div>
                <div class="card-preview">
                    <img src="/static/{{ project.head.folder }}/{{ card.image }}" alt="Substitute Management Screenshot">
                </div>
                <div class="card-footer">
                    <h3>Substitute Management</h3>
                    <p>Real-time teacher substitution system</p>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- Modal -->
    <div id="archive-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-close">Ã—</span>
                <div class="modal-info">
                    <!-- <span id="modal-id" class="modal-id"></span> -->
                    <span id="modal-classification" class="modal-classification"></span>
                </div>
            </div>
            <div class="modal-body">
                <div class="modal-image-container">
                    <img id="modal-image" src="" alt="Screenshot">
                </div>
                <div class="modal-details">
                    <h2 id="modal-title"></h2>
                    <p id="modal-description"></p>
                    <div class="modal-meta">
                        <span class="meta-item">Category: <span id="modal-security"></span></span>

                        <!-- Key features -->
                        <ul class="modal-keyfeatures"></ul>

                    </div>
                </div>
            </div>
        </div>
    </div>
</section>


<script>
    const allCardDualCanvas = document.querySelectorAll('.card-dual-canvas');

    var c = 0

    var fullWindow = [-5, 5, -10, 10]
    var canvasLength = allCardDualCanvas.length;

    allCardDualCanvas.forEach(dualCanvas=> {
        c++

        var window = [
            fullWindow[0] * c/canvasLength,
            fullWindow[1] * (c+1)/canvasLength,
            fullWindow[2] * c/canvasLength,
            fullWindow[3] * (c+1)/canvasLength
        ]

        drawDualCanvas(dualCanvas, f, window, zValues, -1, 1, colorgradient_dark_cream); 
    });

</script>


<script>
    const carousel = document.getElementById('carousel-techstack');
    let currentIndex = 0;
    var track = carousel.querySelector('.carousel-track');
    var items = Array.from(track.children);
    var gap = 20;

    function updateCarousel() {

        var itemWidth = items[0].getBoundingClientRect().width;

        // Get first item and move it to the back
        var firstItem = items.shift();
        firstItem.style.left = `${itemWidth}px`;
        firstItem.style.opacity = 0
        items.push(firstItem);
        items.forEach((item, index) => {
            item.style.left = `${index * gap + index * itemWidth - itemWidth}px`;
            
            if (item != firstItem) {
                item.style.opacity = 1;
            }
        });
    }

    items[0].addEventListener('transitionend', updateCarousel);
    
    setTimeout(() => {
        updateCarousel();
    }, 250);
    updateCarousel()

    // Update the carousel track height based on the height of the tallest item
    function updateCarouselHeight() {
        var maxHeight = 0;
        items.forEach(item => {
            var itemHeight = item.getBoundingClientRect().height;
            if (itemHeight > maxHeight) {
                maxHeight = itemHeight;
            }
        });
        track.style.height = `${maxHeight}px`;
    }
    updateCarouselHeight();

    // Archive Modal Functionality
    const modal = document.getElementById('archive-modal');
    const modalImage = document.getElementById('modal-image');
    const modalTitle = document.getElementById('modal-title');
    const modalDescription = document.getElementById('modal-description');
    const modalId = document.getElementById('modal-id');
    const modalClassification = document.getElementById('modal-classification');
    const modalSecurity = document.getElementById('modal-security');
    const modalClose = document.querySelector('.modal-close');

    // Add click event to all archive cards
    document.querySelectorAll('.archive-card').forEach(card => {
        card.addEventListener('click', function() {
            const image = this.dataset.image;
            const title = this.dataset.title;
            const description = this.dataset.description;
            // const id = this.querySelector('.card-id').textContent;
            const classification = this.querySelector('.card-classification').textContent;

            modalImage.src = image;
            modalTitle.textContent = title;
            modalDescription.textContent = description;
            modalClassification.textContent = classification;
            modalSecurity.textContent = classification;

            // Add keyfeatures
            const keyFeatures = this.dataset.keyfeatures.split(',');
            const keyFeaturesList = modal.querySelector('.modal-keyfeatures');
            keyFeaturesList.innerHTML = '';
            keyFeatures.forEach(feature => {
                const li = document.createElement('li');
                li.textContent = feature.trim();
                keyFeaturesList.appendChild(li);
            });

            modal.style.display = 'block';
            document.body.style.overflow = 'hidden';
        });
    });

    // Close modal when clicking the close button
    modalClose.addEventListener('click', function() {
        modal.style.display = 'none';
        document.body.style.overflow = 'auto';
    });

    // Close modal when clicking outside the modal content
    modal.addEventListener('click', function(event) {
        if (event.target === modal) {
            modal.style.display = 'none';
            document.body.style.overflow = 'auto';
        }
    });

    // Close modal with Escape key
    document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape' && modal.style.display === 'block') {
            modal.style.display = 'none';
            document.body.style.overflow = 'auto';
        }
    });

</script>


{% endblock %}
